window.setImmediate||function(){"use strict";var i=0,o={},u=!0,r=Array.prototype.slice,c="setImmediatePolyfillMessage";function a(n){var e,t=n.data;"string"==typeof t&&0==t.indexOf(c)&&(e=o[t])&&(delete o[t],function(n){var e=n[0];switch(n.length){case 1:return e();case 2:return e(n[1]);case 3:return e(n[1],n[2])}e.apply(window,r.call(n,1))}(e))}window.setImmediate=function(){for(var n=i++,e=c+n,t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return o[e]=r,u&&(u=!1,window.addEventListener("message",a)),window.postMessage(e,"*"),n},window.clearImmediate=function(n){delete o[c+n]}}(),function(n){"use strict";var d="[[PromiseStatus]]",h="[[PromiseValue]]",w="[[OnFulfilled]]",m="[[OnRejected]]",f="[[OriginalError]]",r="pending",o="internal pending",p="fulfilled",y="rejected",s="not an array.",e='constructor Promise requires "new".',v=n.setImmediate||require("timers").setImmediate,l=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)};function i(n){this[f]=n}function g(n){return n instanceof i}function u(n){return"function"==typeof n}function P(n){return n instanceof A}function t(n){return n}function c(n){throw n}function a(n){delete n[w],delete n[m]}function j(n){for(var e=n.length,t=0;t<e;t++)n[t]()}function E(n,e,t){var r=I(t);P(r)?r.then(n,e):g(r)?e(r[f]):n(t)}function I(t){var r,n;if(P(t))return t;if(n=t,Object(n)===n){try{r=t.then}catch(n){return new i(n)}if(u(r))return new A(function(n,e){v(function(){try{r.call(t,n,e)}catch(n){e(n)}})})}return null}function O(e,n){function t(n){e[d]==r&&b(e,n)}try{n(function(n){e[d]==r&&!function e(t,n){var r;var i=I(n);P(i)?(t[d]=o,i.then(function(n){e(t,n)},function(n){b(t,n)})):g(i)?b(t,i[f]):(t[d]=p,t[h]=n,(r=t[w])&&r.length&&(a(t),j(r)))}(e,n)},t)}catch(n){t(n)}}function b(n,e){var t=n[m];n[d]=y,n[h]=e,t&&t.length&&(a(n),j(t))}function A(n){if(!P(this))throw new TypeError(e);this[d]=r,this[h]=void 0,O(this,n)}A.prototype.then=function(a,f){var s,l=this;return a=u(a)?a:t,f=u(f)?f:c,s=new A(function(t,r){function n(n){var e;try{e=n(l[h])}catch(n){return void r(n)}e===s?r(new TypeError("then() cannot return same Promise that it resolves.")):E(t,r,e)}function e(){v(n,a)}function i(){v(n,f)}switch(l[d]){case p:e();break;case y:i();break;default:u=e,c=i,(o=l)[w]||(o[w]=[],o[m]=[]),o[w].push(u),o[m].push(c)}var o,u,c})},A.prototype.catch=function(n){return this.then(t,n)},A.resolve=function(t){var r=I(t);return P(r)?r:new A(function(n,e){g(r)?e(r[f]):n(t)})},A.reject=function(t){return new A(function(n,e){e(t)})},A.race=function(i){return new A(function(n,e){var t,r;if(l(i))for(r=i.length,t=0;t<r;t++)E(n,e,i[t]);else e(new TypeError(s))})},A.all=function(a){return new A(function(t,n){var e,r,i,o,u=0,c=0;if(l(a)){for(r=(a=a.slice(0)).length,o=0;o<r;o++)P(e=I(i=a[o]))?(c++,e.then(function(e){return function(n){a[e]=n,++u==c&&t(a)}}(o),n)):g(e)?n(e[f]):a[o]=i;c||t(a)}else n(new TypeError(s))})},"undefined"!=typeof module&&module.exports?module.exports=n.Promise||A:n.Promise||(n.Promise=A)}(this);